Sub ticker()
For Each WS In Worksheets
'Establish variables
    Dim ticker As String
    Dim volume As Double
        volume = 0
    Dim yearly_change As Double
    
    Dim per_change As Integer
    Summary_Table_Row = 2
    yr_openrow = 2
    lastrow = WS.Cells(Rows.Count, 1).End(xlUp).Row
    'Loop through data
    For i = 2 To lastrow
    yr_open = Cells(yr_openrow, 3).Value
    volume = volume + Cells(i, 7).Value
    If Cells(i + 1, 1).Value <> Cells(i, 1).Value Then
    ticker = Cells(i, 1).Value
    yr_close = Cells(i, 6).Value
    yearly_change = yr_close - yr_open
        Range("K" & Summary_Table_Row).Value = ticker
        Range("N" & Summary_Table_Row).Value = volume
        Range("L" & Summary_Table_Row).Value = yearly_change
        If yr_open = 0 Then
                    Range("M" & Summary_Table_Row).Value = 0
    Else
         per_change = yearly_change / yr_open
         Range("M" & Summary_Table_Row).Value = per_change
                End If
             Range("N" & Summary_Table_Row).Value = volume
             Summary_Table_Row = Summary_Table_Row + 1
             yr_openrow = i + 1
        
    
        
  End If
  Next i
  Next WS

End Sub

